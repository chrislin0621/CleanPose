setting: supervised

train_dataset:
  dataset_name: housecat6d
  dataset_dir: ./housecat6d
  init_tensor_list_dir: ./tensor_list_housecat6d.pkl
  seq_length: -1  # -1 means full
  img_length: -1
  image_size: 224
  sample_num: 1024
  batchsize: 36
  num_workers: 12
  shuffle: True
  drop_last: True
  pin_memory: True

test_dataset:
  img_size: 224
  sample_num: 1024
  dataset_dir: ./housecat6d
  dataset_name: housecat6d
  tensor_list_dir: log/housecat6d/ckpt/tensor_list_housecat6d_100.pkl'

select_num: 12

pose_net:
  rgb_backbone: dino    # [resnet, dino]
  cat_num: 10
  distillation_feat_dim: 768 #[256(pn),768(pointbert)]
  angle_range: 20
  FDEncoder:
    feat_dim: 256
    AttnLayer:
      block_num: 4
      d_model: 256
      dim_ffn: 256
      num_head: 4
    SelfAttnLayer:
      block_num: 2
      d_model: 256
      dim_ffn: 256
      num_head: 4
  IAKD:
    kpt_num: 96
    query_dim: 256
    AttnLayer:
      block_num: 4
      d_model: 256
      dim_ffn: 256
      num_head: 4
  GAFA:
    block_num: 2
    K: [16, 32]
    d_model: 256
  NOCS_Predictor:
    cat_num: 10
    bins_num: 64
    AttnLayer:
      block_num: 2
      d_model: 256
      dim_ffn: 256
      num_head: 4
  Reconstructor:
    pts_per_kpt: 10
    ndim: 256

optimizer:
  name: Adam
  lr: 0.01
  weight_decay: 0

lr_scheduler:
  name: CyclicLR
  mode: triangular
  base_lr: 0.00002
  max_lr: 0.0005
  step_size_up: 14250
  step_size_down: 14250
  cycle_momentum: False

max_epoch : 150

loss:
  cd: 2.0
  nocs: 2.0
  recon: 15.0
  delta: 1.0
  diversity: 10.0
  pose: 0.3
  th: 0.01
  obj_aware: False
  distillation: 0.01
  
rd_seed: 42

per_val: 10  # do the evaluation per per_val epochs 
per_write: 50  # write down the info per per_write iterations